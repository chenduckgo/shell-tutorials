# Shell Tutorials

```
echo $SHELL
```

## 系统是如何操作计算机硬件？
通过`Linux内`核


## Shell
编写`shell`命令发送给`Linux`内核，从而操作计算机硬件。
`shell`是一门程序设计语言，其中有变量、函数、逻辑控制等。


## 脚本规范
* 文件后缀名：`.sh`
* 首行需要设置解析器类型：`#!/bin/bash`
* 注释
    * 单行注释：`# 注释内容`
    * 多行注释：`:<<! 注释内容 !`


## 执行Shell脚本的方式
* `sh`解析器执行方式
    * 语法：`sh 脚本文件`
    * 本质就是使用`Shell`解析器执行脚本文件
* `bash`解析器执行方式
    * 语法：`bash 脚本文件`
    * 本质就是使用`bash`解析器执行脚本文件
* 仅路径执行方式
    * 语法：`./脚本文件`
    * 执行当前目录下的脚本文件，需要可执行权限


## Shell变量
存储管理临时数据

### 系统环境变量
Linux系统加载Shell配置文件中定义的变量，共享给所有Shell程序使用
* 全局配置文件
    * `/etc/profile`
    * `/etc/profile.d/*.sh`
    * `/etc/bashrc`
* 个人配置文件
    * 当前用户`.bash_profile`
    * 当前用户`.bashrc`

### 常见环境变量

| 变量       | 含义         |
|----------|------------|
| PATH     | 命令的搜索路径    |
| HOME     | 主目录        |
| SHELL    | Shell解释器类型 |
| HISTFILE | 命令历史文件     |
| PWD      | 当前目录路径     |
| OLDPWD   | 上次所在的目录    |
| HOSTNAME | 主机名        |
| HOSTTYPE | 主机架构       |
| LANG     | 当前系统语言     |


## 自定义变量

### 自定义局部变量
* 定义在脚本文件中，只能在该脚本中使用。
* `varname=value`，等号两侧不能有空格
* 变量默认都是字符类型，无法直接进行数值运算
* 变量的值如果有空格，必须用括号括起来
* 只能是字母、数字、下划线开头，不能使用`Shell`中的关键字
* 查看变量
  * `$var_name`
  * `${var_name}`，适合拼接字符串
* 删除变量：`unset var_name`

### 自定义常量
* 初始化后不能修改的变量
* `readonly var_name`

### 自定义全局变量
* 在当前脚本文件中定义全局变量，该变量可在当前环境和子shell环境中使用
* `export var_name1 var_name2`

### 特殊变量
* `$n`：接收输入参数
  * `$0`用于获取当前脚本名称，`$1`-`$9`代表第1个到第9个参数
  * `$0`-`$9`也可以用`${0}`-`${9}`
  * 第10个及以上的参数：`${数字}`
* `$#`
  * 输入参数的个数
* `$*`
  * 所有输入参数，不包含第0个
  * `"$*"`：所有参数拼接位一个字符串
* `$@`
  * 所有输入参数，不包含第0个
  * `"$@"`：获取一个参数列表，每个参数单独是一个字符串
* `$?`
  * 上一个shell命令的退出码
  * 函数的返回值
  * 每个shell命令都有一个返回值，表示命令是否执行成功，0成功，非0失败。
* `$$`
  * 当前shell环境的进程ID

### 系统环境变量
当用户进入shell环境时会加载全局配置文件`/etc/profile`中的环境变量，供给所有shell程序使用
* 定义环境变量：`export VAR_NAME=value`
* 重载配置文件：`source /etc/profile`

## Shell工作环境
用户进入Linux系统，就会初始化shell环境，会加载全局和个人的配置文件中的环境变量。

### 交互式shell
与用户交互，用户输入一个命令，shell环境立刻反馈响应

### 非交互式shell
不需要用户参与就可以执行多个命令，如脚本文件

### shell登录环境
需要用户名、密码登录的shell环境

### shell非登录
不需要用户名、密码的shell环境或执行脚本文件

## 环境变量的初始化流程

### shell登录环境执行脚本文件语法
`sh/bash -l/--login 脚本文件`

### shell非登录环境执行脚本语法
```
bash
sh/bash 脚本文件
```
### 识别登录和非登录环境
`echo $0`
* `-bash`：登录环境
* `bash`：非登录环境

### 切换shell环境
* 使用用户名密码登录的都是shell登录环境
* su切换用户
  * `su user -l/--login`：登录环境
  * `su user`：非登录环境
* `bash`切换
  * `bash`：非登录环境
  * `bash/sh -l/--login 脚本文件`：登录环境




















